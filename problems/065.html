<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<html><head>


<title>ElJudge - Online MIPT programming contest </title>
<meta http-equiv="content-type" content="text/html; charset=KOI8-R">
<meta name="description" content="ElJudge online programming contest on algorithms">
<meta name="keywords" content="programmers, programming skills, programming contest, ELJudge, algorithms, computer science, online-contest, олимпиада, problems, информатика, задачи, алгоритмы, программирование">
<link rel="stylesheet" href="065_files/judge.css" type="text/css">
<link rel="shortcut icon" href="http://acm.mipt.ru/favicon.ico">
<script language="JavaScript" src="065_files/dyn.js" type="text/javascript"></script>
</head><body>
<div class="judge">
  <div id="pageheader">
    <div class="fancyname">El Judge</div>
    <div class="description"><table width="100%"><tbody><tr><td style="border: medium none ;">Online MIPT programming contest</td><td style="border: medium none ;" align="right">
<a href="http://acm.mipt.ru/judge/problems.pl?problem=065&amp;lang=ru&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">РУССКИЙ</a>    </td></tr></tbody></table></div>
  </div>
  <div id="bbar">
    <div class="address">
    <a href="http://acm.mipt.ru/board">Forum</a> ||
<a href="http://acm.mipt.ru/judge/register.pl?CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">Register</a> || <a href="http://acm.mipt.ru/judge/submit.pl?CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">Submit</a> || <a href="http://acm.mipt.ru/judge/problems.pl?CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">Problem&nbsp;set</a> || <a href="http://acm.mipt.ru/judge/users.pl?CGISESSID=84dfdb7dd8d03c56e50becb8b6771937#me">Users&nbsp;rating</a> || <a href="http://acm.mipt.ru/judge/status.pl?CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">Online&nbsp;status</a> || <a href="http://acm.mipt.ru/judge/messenger.pl?CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">Messenger</a> || <a href="http://acm.mipt.ru/judge/login.pl?logout=yes&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">Exit</a> || <a href="http://acm.mipt.ru/judge/info.pl?CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">FAQ</a> ||   <a href="http://acm.mipt.ru/">acm.mipt.ru</a>
<!-- <a href="/cgi-bin/team">[LOGIN&nbsp;TO&nbsp;CONTEST]</a> -->
<!-- <a href="contest/standings.pl">[Final&nbsp;&nbsp;standings]</a> -->
</div></div>
<!--<hr width="100%">-->
<div id="text">
<script language="JavaScript" src="065_files/jsf.js" type="text/javascript"></script>
<script language="JavaScript" src="065_files/jsf_002.js" type="text/javascript"></script>
	<small>
</small><table class="noborder" style="" cellpadding="0">
<tbody><tr>
	<td nowrap="nowrap"><a href="http://acm.mipt.ru/judge/problems.pl?problem=064&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">&lt;PREV</a> Problem:</td>
	<td>
		<form align="left" action="problems.pl" method="get" style="" size="5" width="5%">
<input name="CGISESSID" value="84dfdb7dd8d03c56e50becb8b6771937" type="hidden">
<input id="prb" name="problem" value="065" size="5" maxsize="5" type="edit">
	</form>
	</td>
	<td>
<a href="http://acm.mipt.ru/judge/problems.pl?problem=066&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">NEXT&gt;</a>Trams : <font color="red"><small>IS NOT SOLVED YET</small></font> <a href="http://acm.mipt.ru/judge/submit.pl?problem=065&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">[SUBMIT]</a> <a href="http://acm.mipt.ru/judge/submit.pl?browse=yes&amp;problem=065&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">[MY SUBMISSIONS]</a></td></tr></tbody></table><small>Solved by <b>460</b> users: ...</small><table style="float: right;"><tbody><tr><td id="stats" style="border: medium none ; display: none;"><small></small><table><caption><div id="statsa"><a href="#" onclick="return chgDisp('stats')">The smallest solutions</a></div><div style="display: none;" id="statsb"><select name="" onchange="document.location = '?CGISESSID=84dfdb7dd8d03c56e50becb8b6771937&amp;st=1&amp;problem=065&amp;stats='+this.options[this.selectedIndex].value" size="3">
<option value="fastest">The fastest solutions</option>
<option value="bestscored">The best scored solutions</option>
<option selected="selected" value="smallest">The smallest solutions</option>
</select></div></caption><tbody><tr><th>User</th><th>Date</th><th colspan="2">Attempt</th><th>Time</th><th><b>CM</b></th><th>SC</th></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=sb3ar&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">sb3ar</a></td><td><code>17 feb 2008</code></td><td>Ruby</td><td>10</td><td>00.13</td><td>69</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=sb3ar&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">sb3ar</a></td><td><code>17 feb 2008</code></td><td>Ruby</td><td>7</td><td>00.13</td><td>87</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=sb3ar&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">sb3ar</a></td><td><code>17 feb 2008</code></td><td>Ruby</td><td>6</td><td>00.13</td><td>94</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=Ali_taldyk&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">Ali_taldyk</a></td><td><code>21 aug 2009</code></td><td>FPC</td><td>1</td><td>00.01</td><td>106</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=mikl&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">mikl</a></td><td><code>21 aug 2007</code></td><td>C++</td><td>6</td><td>00.04</td><td>110</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=mikl&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">mikl</a></td><td><code>21 aug 2007</code></td><td>C++</td><td>5</td><td>00.04</td><td>112</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=Vman&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">Vman</a></td><td><code>17 sep 2006</code></td><td>FPC</td><td>3</td><td>00.01</td><td>118</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=WsemirZ&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">WsemirZ</a></td><td><code>29 dec 2007</code></td><td>FPC</td><td>8</td><td>00.01</td><td>118</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=WsemirZ&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">WsemirZ</a></td><td><code>29 dec 2007</code></td><td>FPC</td><td>10</td><td>00.01</td><td>118</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=WsemirZ&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">WsemirZ</a></td><td><code>29 dec 2007</code></td><td>FPC</td><td>9</td><td>00.01</td><td>120</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=WsemirZ&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">WsemirZ</a></td><td><code>29 dec 2007</code></td><td>FPC</td><td>11</td><td>00.01</td><td>120</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=zkw&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">zkw</a></td><td><code>14 may 2009</code></td><td>Lua</td><td>1</td><td>00.06</td><td>120</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=Vladislav_Simonenko&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">Vladislav_Simonenko</a></td><td><code>16 mar 2006</code></td><td>C++</td><td>2</td><td>00.13</td><td>123</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=ninZa_beri&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">ninZa_beri</a></td><td><code>13 feb 2007</code></td><td>C++</td><td>1</td><td>00.02</td><td>127</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=bush&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">bush</a></td><td><code>10 mar 2006</code></td><td>Ruby</td><td>1</td><td>00.12</td><td>127</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=Darii&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">Darii</a></td><td><code>30 sep 2009</code></td><td>Kylix</td><td>2</td><td>00.02</td><td>129</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=Vman&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">Vman</a></td><td><code>17 sep 2006</code></td><td>FPC</td><td>2</td><td>00.01</td><td>132</td><td>&nbsp;</td></tr><tr><td><a href="http://acm.mipt.ru/judge/users.pl?user=WsemirZ&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">WsemirZ</a></td><td><code>29 dec 2007</code></td><td>FPC</td><td>5</td><td>00.01</td><td>132</td><td>&nbsp;</td></tr></tbody></table><small></small><div align="center"><table width="250"><caption>Languages</caption><tbody><tr><td class="sh" nowrap="nowrap">C++</td><td class="st" align="left"><div style="width: 100%;">199</div></td></tr><tr><td class="sh" nowrap="nowrap">FPC</td><td class="st" align="left"><div style="width: 76.38%;">152</div></td></tr><tr><td class="sh" nowrap="nowrap">C</td><td class="st" align="left"><div style="width: 25.63%;">51</div></td></tr><tr><td class="sh" nowrap="nowrap">Kylix</td><td class="st" align="left"><div style="width: 19.6%;">39</div></td></tr><tr><td class="sh" nowrap="nowrap">Java</td><td class="st" align="left"><div style="width: 10.55%;">21</div></td></tr><tr><td class="sh" nowrap="nowrap">Ruby</td><td class="st" align="left"><div style="width: 1.51%;">3</div></td></tr><tr><td class="sh" nowrap="nowrap">Lua</td><td class="st" align="left"><div style="width: 0.5%;">1</div></td></tr></tbody></table></div></td><th style="padding: 0px;"><a href="http://acm.mipt.ru/judge/problems.pl?problem=065&amp;st=1&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937" onclick="tgs(); return false;"><code id="ssmsg">&nbsp;&lt;&nbsp;<br>&nbsp;&lt;&nbsp;<br>&nbsp;&lt;&nbsp;<br>&nbsp;&lt;&nbsp;<br>&nbsp;&lt;&nbsp;<br>&nbsp;&lt;&nbsp;<br>&nbsp;&lt;&nbsp;<br>&nbsp;&lt;&nbsp;<br>&nbsp;&lt;&nbsp;<br>&nbsp;&lt;&nbsp;<br></code></a></th></tr></tbody></table><p align="justify"></p><h2>Queue for tickets</h2>
<p align="center"> Time limit = 5
second(s)</p>
N mans are standing in a queue to buy tickets for a new musical. Each
person wants to buy exactly one ticket. There was only one ticket
window open so the booking went slowly driving guests to despair.
The most intelligent ones noted that, generally, cashier sold several
tickets to the one man faster, than when the same tickets were sold one
by one.
So, they suggested that several successive mans should hand their money
over to the first of them to buy the tickets for the whole group at
once.
<p>However, the cashier struggled against profiters, and refused to
sell more than three tickets to the same man, so that scheme was
useful only for two or three successive persons.
</p><p>It is known, it takes <i>A<sub>i</sub></i> seconds for the <i>i</i>-th man to buy one ticket, <i>B<sub>i</sub></i> seconds to buy two and <i>C<sub>i</sub></i> to buy three ones.

</p><p>You are to find out the minimal time that whould have taken for the whole queue to get served.

</p><p>Please, note that the tickets are always bought by the first
person of each group. Noone speeds up the process by purchasing
additional (unnessesary) tickets.
</p><p></p><p><b>Input</b><br>
The first line contains one integer <i>N</i>, that is the size of the queue (1 ≤ <i>N</i> ≤ 5000). 
Than follow <i>N</i> triples of integers <i>A<sub>i</sub></i>, <i>B<sub>i</sub></i>, <i>C<sub>i</sub></i>, that do not exceed 3600.
The mans are ordered from the ticket window.

</p><p></p><p><b>Output</b><br>
One integer that is equal to the minimal number of seconds for the whole queue to get served.

</p><p>
</p><table class="sample" border="1" cellpadding="10"><tbody><tr><td valign="top">
Input#1<pre>5
5 10 15
2 10 15
5 5 5
20 20 1
20 1 1
</pre></td>
<td valign="top">
Output#1<pre>12

</pre></td></tr></tbody></table>
<table class="sample" border="1" cellpadding="10"><tbody><tr><td valign="top">
Input#2<pre>2

3 4 5
1 1 1

</pre></td>
<td valign="top">
Output#2<pre>4

</pre></td></tr></tbody></table>
<p><b>Author:<br>
<br></b>
<small><i></i></small></p><p align="center"><a href="http://acm.mipt.ru/judge/problems.pl?problem=064&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">&lt;PREV</a> | <a href="http://acm.mipt.ru/judge/problems.pl?CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">Problem set</a> | <a href="http://acm.mipt.ru/board/?searchword=065" target="_blank">Search related messages</a> | <a href="http://acm.mipt.ru/judge/problems.pl?problem=066&amp;CGISESSID=84dfdb7dd8d03c56e50becb8b6771937">NEXT&gt;</a></p><script language="JavaScript" src="065_files/jsf_003.js" type="text/javascript"></script>
</div><hr style="clear: both;"><table width="100%"><tbody><tr>
<td style="border: medium none ;"><div align="right"><small>© acm.mipt DevGroup<br>The page was generated in <b style="clear: left;">320</b>ms</small><br><script language="JavaScript" src="065_files/gz.asc" type="text/javascript"></script><small>gzip statistics is not avaliable</small><script language="JavaScript">
jsm.attach("prb","array",problems);
</script>
</div></td></tr></tbody></table><div align="center"><a href="http://combalg.ru/"><img style="border: 0pt none ;" src="065_files/combalg_bg_small.png"></a></div></div><div style="display: none;">ID = 10.55.119.39</div></body></html>